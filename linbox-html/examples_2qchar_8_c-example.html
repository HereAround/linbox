<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>linbox: examples/qchar.C</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">linbox
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',false,false,'search.php','Search');
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">examples/qchar.C</div>  </div>
</div><!--header-->
<div class="contents">
<p>Undocumented.</p>
<div class="fragment"><div class="line"><span class="comment">/*</span></div><div class="line"><span class="comment"> * examples/qchar.C</span></div><div class="line"><span class="comment"> *</span></div><div class="line"><span class="comment"> * Copyright (C) 2007, 2010 A. Urbanska</span></div><div class="line"><span class="comment"> * ========LICENCE========</span></div><div class="line"><span class="comment"> * This file is part of the library LinBox.</span></div><div class="line"><span class="comment"> *</span></div><div class="line"><span class="comment"> * LinBox is free software: you can redistribute it and/or modify</span></div><div class="line"><span class="comment"> * it under the terms of the  GNU Lesser General Public</span></div><div class="line"><span class="comment"> * License as published by the Free Software Foundation; either</span></div><div class="line"><span class="comment"> * version 2.1 of the License, or (at your option) any later version.</span></div><div class="line"><span class="comment"> *</span></div><div class="line"><span class="comment"> * This library is distributed in the hope that it will be useful,</span></div><div class="line"><span class="comment"> * but WITHOUT ANY WARRANTY; without even the implied warranty of</span></div><div class="line"><span class="comment"> * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU</span></div><div class="line"><span class="comment"> * Lesser General Public License for more details.</span></div><div class="line"><span class="comment"> *</span></div><div class="line"><span class="comment"> * You should have received a copy of the GNU Lesser General Public</span></div><div class="line"><span class="comment"> * License along with this library; if not, write to the Free Software</span></div><div class="line"><span class="comment"> * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301  USA</span></div><div class="line"><span class="comment"> * ========LICENCE========</span></div><div class="line"><span class="comment"> */</span></div><div class="line"></div><div class="line"><span class="preprocessor">#include &lt;givaro/modular.h&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;linbox/field/gmp-rational.h&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="dense-matrix_8h.html">linbox/matrix/dense-matrix.h</a>&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="sparse-matrix_8h.html">linbox/matrix/sparse-matrix.h</a>&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;linbox/solutions/charpoly.h&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;linbox/solutions/minpoly.h&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;linbox/ring/polynomial-ring.h&gt;</span></div><div class="line"></div><div class="line"><span class="keyword">using namespace </span><a class="code" href="namespace_lin_box.html">LinBox</a>;</div><div class="line"><span class="keyword">using namespace </span><a class="code" href="namespacestd.html">std</a>;</div><div class="line"></div><div class="line"><span class="keyword">typedef</span> Givaro::ZRing&lt;Integer&gt; Integers;</div><div class="line"><span class="keyword">typedef</span> Integers::Element Integer;</div><div class="line"><span class="keyword">typedef</span> Givaro::Modular&lt;double &gt; Field;</div><div class="line"><span class="keyword">typedef</span> Field::Element Element;</div><div class="line"><span class="keyword">typedef</span> <a name="_a0"></a><a class="code" href="struct_lin_box_1_1_vector.html">Vector&lt;Integers&gt;::Dense</a> DVector;</div><div class="line"><span class="keyword">typedef</span> GMPRationalField Rationals;</div><div class="line"><span class="keyword">typedef</span> <a name="_a1"></a><a class="code" href="class_lin_box_1_1_g_m_p_rational_element.html">Rationals::Element</a> <a class="code" href="class_lin_box_1_1_g_m_p_rational_element.html">Quotient</a>;</div><div class="line"><span class="keyword">typedef</span> <a name="_a2"></a><a class="code" href="class_lin_box_1_1_blas_matrix.html">DenseMatrix&lt;Integers &gt;</a> Blackbox;</div><div class="line"><span class="keyword">typedef</span> SparseMatrix&lt;Rationals &gt; RBlackbox;</div><div class="line"></div><div class="line"><span class="comment">//#define _LB_CONT_FR</span></div><div class="line"></div><div class="line"><span class="keyword">typedef</span> UserTimer myTimer;</div><div class="line"></div><div class="line">myTimer tRationalModular;</div><div class="line"></div><div class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> Field, <span class="keyword">class</span> Polynomial&gt;</div><div class="line">std::ostream&amp; <a name="a3"></a><a class="code" href="minpoly_8_c.html#ae5e6ddcaeea308483d81a1295dfb797a">printPolynomial</a> (std::ostream&amp; out, <span class="keyword">const</span> Field &amp;F, <span class="keyword">const</span> Polynomial &amp;v)</div><div class="line">{</div><div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = v.size () - 1; i &gt;= 0; i--) {</div><div class="line">        F.write (out, v[i]);</div><div class="line">        <span class="keywordflow">if</span> (i &gt; 0)</div><div class="line">            out &lt;&lt; <span class="stringliteral">&quot; X^&quot;</span> &lt;&lt; i &lt;&lt; <span class="stringliteral">&quot; + &quot;</span>;</div><div class="line">        out &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div><div class="line">    }</div><div class="line">    <span class="keywordflow">return</span> out;</div><div class="line">}</div><div class="line"></div><div class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> Blackbox, <span class="keyword">class</span> MyMethod&gt;</div><div class="line"><span class="keyword">struct </span>PrecRationalModularCharpoly {</div><div class="line">    <span class="keyword">const</span> Blackbox &amp;A;</div><div class="line">    <span class="keyword">const</span> MyMethod &amp;M;</div><div class="line">    <span class="keyword">const</span> Integer &amp;prec;</div><div class="line"></div><div class="line">    PrecRationalModularCharpoly(<span class="keyword">const</span> Integer&amp; detPrec, <span class="keyword">const</span> Blackbox&amp; b, <span class="keyword">const</span> MyMethod&amp; n) :</div><div class="line">        prec(detPrec), A(b), M(n)</div><div class="line">    {}</div><div class="line"></div><div class="line">    <span class="keyword">template</span>&lt;<span class="keyword">typename</span> Polynomial, <span class="keyword">typename</span> Field&gt;</div><div class="line">    Polynomial&amp; operator()(Polynomial&amp; P, <span class="keyword">const</span> Field&amp; F)<span class="keyword"> const</span></div><div class="line"><span class="keyword">    </span>{</div><div class="line"></div><div class="line">        <span class="keyword">typedef</span> <span class="keyword">typename</span> Blackbox::template rebind&lt;Field&gt;::other FBlackbox;</div><div class="line">        FBlackbox * Ap;</div><div class="line"></div><div class="line">        tRationalModular.clear();</div><div class="line">        tRationalModular.start();</div><div class="line">        MatrixHom::map(Ap, A, F);</div><div class="line">        tRationalModular.stop();</div><div class="line">        <span class="comment">//minpoly(P, *Ap, typename FieldTraits&lt;Field&gt;::categoryTag(), M);</span></div><div class="line">        charpoly( P, *Ap, <span class="keyword">typename</span> <a name="_a4"></a><a class="code" href="struct_lin_box_1_1_ring_categories_1_1_generic_tag.html">FieldTraits&lt;Field&gt;::categoryTag</a>(), M);</div><div class="line">        <span class="comment">//minpolySymmetric(P, *Ap, typename FieldTraits&lt;Field&gt;::categoryTag(), M);</span></div><div class="line">        <a class="code" href="group__integers.html#ga69460c665a80daebb395e45f6f76db54">integer</a> p;</div><div class="line">        F.characteristic(p);</div><div class="line">        cout&lt;&lt;<span class="stringliteral">&quot;Valence &quot;</span>&lt;&lt;p&lt;&lt;<span class="stringliteral">&quot; = P[P.size()-1]&quot;</span> &lt;&lt; P[P.size(0)-1] &lt;&lt; <span class="stringliteral">&quot; R-M time &quot;</span> ;</div><div class="line">        tRationalModular.print(cout);</div><div class="line">        cout &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span> ;</div><div class="line"></div><div class="line">        <span class="keyword">typename</span> Field::Element fprec;</div><div class="line">        F.init(fprec, prec);</div><div class="line">        <span class="comment">//printPolynomial (std::cout, F, P);</span></div><div class="line">        <span class="keyword">delete</span> Ap;</div><div class="line"></div><div class="line">        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i &lt; P.size(); ++i)</div><div class="line">            F.mulin(P[i],fprec);</div><div class="line">        <span class="comment">//std::cout&lt;&lt;&quot;prec*Det(A) mod &quot;&lt;&lt;p&lt;&lt;&quot; = P[0]&quot; &lt;&lt; P[0] &lt;&lt; &quot;\n&quot;;</span></div><div class="line">        <span class="keywordflow">return</span> P;</div><div class="line">    }</div><div class="line">};</div><div class="line"></div><div class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> Blackbox, <span class="keyword">class</span> MyMethod&gt;</div><div class="line"><span class="keyword">struct </span>PrecRationalModularMinpoly {</div><div class="line">    <span class="keyword">const</span> Blackbox &amp;A;</div><div class="line">    <span class="keyword">const</span> MyMethod &amp;M;</div><div class="line">    <span class="keyword">const</span> DVector &amp;prec;</div><div class="line"></div><div class="line"></div><div class="line">    PrecRationalModularMinpoly(<span class="keyword">const</span> DVector&amp; detPrec, <span class="keyword">const</span> Blackbox&amp; b, <span class="keyword">const</span> MyMethod&amp; n) :</div><div class="line">        prec(detPrec), A(b), M(n)</div><div class="line">    {}</div><div class="line"></div><div class="line">    <span class="keyword">template</span>&lt;<span class="keyword">typename</span> Polynomial, <span class="keyword">typename</span> Field&gt;</div><div class="line">    <a class="code" href="namespace_lin_box.html#aa01a95537fc86573cc753898e378253b">IterationResult</a> operator()(Polynomial&amp; P, <span class="keyword">const</span> Field&amp; F)<span class="keyword"> const</span></div><div class="line"><span class="keyword">    </span>{</div><div class="line"></div><div class="line">        <span class="keyword">typedef</span> <span class="keyword">typename</span> Blackbox::template rebind&lt;Field&gt;::other FBlackbox;</div><div class="line">        FBlackbox * Ap;</div><div class="line"></div><div class="line">        tRationalModular.clear();</div><div class="line">        tRationalModular.start();</div><div class="line">        MatrixHom::map(Ap, A, F);</div><div class="line">        tRationalModular.stop();</div><div class="line">        <span class="comment">//minpoly(P, *Ap, typename FieldTraits&lt;Field&gt;::categoryTag(), M);</span></div><div class="line">        <span class="comment">//charpoly( P, *Ap, typename FieldTraits&lt;Field&gt;::categoryTag(), M);</span></div><div class="line">        minpolySymmetric(P, *Ap, <span class="keyword">typename</span> <a class="code" href="struct_lin_box_1_1_ring_categories_1_1_generic_tag.html">FieldTraits&lt;Field&gt;::categoryTag</a>(), M);</div><div class="line">        <a class="code" href="group__integers.html#ga69460c665a80daebb395e45f6f76db54">integer</a> p;</div><div class="line">        F.characteristic(p);</div><div class="line">        <span class="comment">//cout&lt;&lt;&quot;Det(A) mod &quot;&lt;&lt;p&lt;&lt;&quot; = P[0]&quot; &lt;&lt; P[0] &lt;&lt; &quot; R-M time &quot; ;</span></div><div class="line">        cout&lt;&lt;<span class="stringliteral">&quot;Valence &quot;</span>&lt;&lt;p&lt;&lt;<span class="stringliteral">&quot; = P[P.size()-1]&quot;</span> &lt;&lt; P[P.size()-1] &lt;&lt; <span class="stringliteral">&quot; R-M time &quot;</span> ;</div><div class="line">        tRationalModular.print(cout);</div><div class="line">        cout &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span> ;</div><div class="line"></div><div class="line">        <span class="keyword">typename</span> Field::Element fprec;</div><div class="line">        <span class="comment">//F.init(fprec, prec);</span></div><div class="line">        <span class="comment">//printPolynomial (std::cout, F, P);</span></div><div class="line">        <span class="keyword">delete</span> Ap;</div><div class="line"></div><div class="line">        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i &lt; P.size()-1; ++i) {</div><div class="line">            F.init(fprec, prec[i]);</div><div class="line">            F.mulin(P[i],fprec);</div><div class="line">        }</div><div class="line">        <span class="comment">//std::cout&lt;&lt;&quot;prec*Det(A) mod &quot;&lt;&lt;p&lt;&lt;&quot; = P[0]&quot; &lt;&lt; P[0] &lt;&lt; &quot;\n&quot;;</span></div><div class="line">        <span class="comment">//printPolynomial(cout,F,P);</span></div><div class="line">                <span class="keywordflow">return</span> <a name="a5"></a><a class="code" href="namespace_lin_box.html#aa01a95537fc86573cc753898e378253ba2f453cfe638e57e27bb0c9512436111e">IterationResult::CONTINUE</a>;</div><div class="line">    }</div><div class="line">};</div><div class="line"></div><div class="line"></div><div class="line"><span class="keywordtype">void</span> continuedFractionIn(<span class="keywordtype">double</span> x,Integer&amp; num, Integer&amp; den, <span class="keywordtype">double</span> epsi,<span class="keyword">const</span> <span class="keywordtype">size_t</span> s, Integer den_bound);</div><div class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> RMatrix&gt;</div><div class="line"><span class="keywordtype">void</span> <a name="a6"></a><a class="code" href="qchar_8_c.html#a4b96d819a68e0cb5bd6177ab8eaa4043">generate_precRatMat</a>(<span class="keywordtype">string</span>&amp; filename, RMatrix&amp; M, DVector&amp; den, Integer&amp; denPrec);</div><div class="line"><span class="keywordtype">void</span> i_vti_v(RBlackbox&amp; Res, <a class="code" href="class_lin_box_1_1_blas_matrix.html">DenseMatrix&lt;Rationals &gt;</a>&amp; M, DVector&amp; den, Integer&amp; detPrec);</div><div class="line"></div><div class="line"><span class="keywordtype">int</span> main (<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span>** argv)</div><div class="line">{</div><div class="line"></div><div class="line">    <span class="keywordflow">if</span> ((argc &lt; 3) || (argc &gt; 4) ) {</div><div class="line">        cout &lt;&lt; <span class="stringliteral">&quot;Usage: qchar n matrix&quot;</span> &lt;&lt; endl;</div><div class="line">        <span class="keywordflow">return</span> -1;</div><div class="line">    }</div><div class="line"></div><div class="line">    <span class="keywordtype">size_t</span> n = atoi(argv[1]);</div><div class="line">    cout &lt;&lt; <span class="stringliteral">&quot;Matrix size &quot;</span> &lt;&lt; n&lt;&lt; endl;</div><div class="line">    <span class="keywordtype">string</span> filename;</div><div class="line">    filename=argv[2];</div><div class="line"></div><div class="line">    Integers Z;</div><div class="line">    Rationals Q;</div><div class="line"></div><div class="line">    Integer detPrec = 1;</div><div class="line">    Integer detNum;</div><div class="line">    Integer detDen;</div><div class="line"></div><div class="line">    Blackbox DM(Z,n,n);</div><div class="line">    <a class="code" href="class_lin_box_1_1_blas_matrix.html">DenseMatrix&lt;Rationals &gt;</a> In(Q,n,n);</div><div class="line">    RBlackbox M(Q,n,n);</div><div class="line">    DVector V(n,1);</div><div class="line"></div><div class="line">    <span class="comment">//  generate_precRatMat(filename, In, V, detPrec);</span></div><div class="line">    <span class="comment">//i_vti_v(M,In, V, detPrec);</span></div><div class="line">    <a class="code" href="qchar_8_c.html#a4b96d819a68e0cb5bd6177ab8eaa4043">generate_precRatMat</a>(filename, M, V, detPrec);</div><div class="line">    cout &lt;&lt; <span class="stringliteral">&quot;detPrec is &quot;</span> &lt;&lt; detPrec  &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div><div class="line">    <span class="keyword">typedef</span> <a name="_a7"></a><a class="code" href="class_lin_box_1_1_polynomial_ring.html">PolynomialRing&lt;Integers&gt;</a> IntPolRing;</div><div class="line">    IntPolRing::Element c_A;</div><div class="line"></div><div class="line">    Integer max = 1,min=0;</div><div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i=0; i &lt; n; ++i) {</div><div class="line">        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> j=0; j &lt; n; ++j) {</div><div class="line">            Integer a;</div><div class="line">            Q.convert(a,M.getEntry(i,j));</div><div class="line">            <span class="comment">//      cerr&lt;&lt;&quot;it=&quot;&lt;&lt;(*it)&lt;&lt;endl;</span></div><div class="line">            <span class="keywordflow">if</span> (max &lt; a)</div><div class="line">                max = a;</div><div class="line">            <span class="keywordflow">if</span> (min &gt; a)</div><div class="line">                min = a;</div><div class="line">        }</div><div class="line">    }</div><div class="line">    <span class="keywordflow">if</span> (max&lt;-min)</div><div class="line">        max=-min;</div><div class="line">    <span class="keywordflow">else</span> max = max+1;</div><div class="line">    <span class="keywordtype">double</span> hadamarcp = (double)n/2.0*(log(<span class="keywordtype">double</span>(n))+2*log(<span class="keywordtype">double</span>(max))+0.21163275)/log(2.0);</div><div class="line"></div><div class="line"></div><div class="line">    cout &lt;&lt; <span class="stringliteral">&quot;had&quot;</span> &lt;&lt; hadamarcp &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div><div class="line">    cout &lt;&lt; <span class="stringliteral">&quot;had2&quot;</span> &lt;&lt; (Integer)hadamarcp*detPrec &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div><div class="line"></div><div class="line">    <a name="_a8"></a><a class="code" href="class_lin_box_1_1_prime_iterator.html">PrimeIterator&lt;IteratorCategories::HeuristicTag&gt;</a> genprime(<a name="_a9"></a><a class="code" href="struct_lin_box_1_1_field_traits.html">FieldTraits&lt;Field&gt;::bestBitSize</a>(M.coldim()));</div><div class="line">    <a name="_a10"></a><a class="code" href="struct_lin_box_1_1_chinese_remainder.html">ChineseRemainder&lt; CRABuilderEarlyMultip&lt;Field  &gt;</a> &gt; cra(LINBOX_DEFAULT_EARLY_TERMINATION_THRESHOLD);</div><div class="line">    <span class="keyword">typedef</span> <a name="a11"></a><a class="code" href="namespace_lin_box.html#a10235377a5d8fe76c611f71b195cb97ea06b9281e396db002010bde1de57262eb">Method::Auto</a> MyMethod;</div><div class="line">    MyMethod Met;</div><div class="line">    <span class="comment">//PrecRationalModularCharpoly &lt;RBlackbox  ,MyMethod&gt; iteration (detPrec, M, Met);</span></div><div class="line">    PrecRationalModularMinpoly&lt; RBlackbox  ,MyMethod&gt; iteration(V, M, Met);</div><div class="line">    cra (c_A, iteration, genprime);</div><div class="line">    <a class="code" href="minpoly_8_c.html#ae5e6ddcaeea308483d81a1295dfb797a">printPolynomial</a>(cout, Z, c_A);</div><div class="line"></div><div class="line">    <span class="keywordflow">return</span> 0 ;</div><div class="line">}</div><div class="line"></div><div class="line"><span class="comment">/* for a rational number num/den construct a continued fraction approximation:</span></div><div class="line"><span class="comment">   - with den bounded by den_bound</span></div><div class="line"><span class="comment">   AND - number of steps bounded by s</span></div><div class="line"><span class="comment">   NEW fraction replaces num/den</span></div><div class="line"><span class="comment">   */</span></div><div class="line"></div><div class="line"><span class="keywordtype">void</span> continuedFractionIn(Integer&amp; num, Integer&amp; den, <span class="keywordtype">double</span> epsi,<span class="keyword">const</span> <span class="keywordtype">size_t</span> s, Integer den_bound)</div><div class="line">{</div><div class="line">    <span class="comment">//den_bound = 100;</span></div><div class="line">    Integer a=num;</div><div class="line">    Integer b=den;</div><div class="line">    Integer t;</div><div class="line">    <span class="comment">//double y;</span></div><div class="line">    Integer f[s];</div><div class="line">    f[0] = a/b;<span class="comment">// y = f[0];</span></div><div class="line">    <span class="keywordtype">int</span> i=1;</div><div class="line">    <span class="keywordflow">while</span> (1) <span class="comment">//abs(y-x)&gt;=epsi)</span></div><div class="line">    {</div><div class="line">        <span class="comment">//cout &lt;&lt; &quot;a :&quot; &lt;&lt; a &lt;&lt; &quot; b: &quot; &lt;&lt; b &lt;&lt; &quot;\n&quot;;</span></div><div class="line">        t = a%b;</div><div class="line">        a = b;</div><div class="line">        b = t;</div><div class="line">        f[i] = a/b;</div><div class="line">        <span class="comment">//y = (double)f[i];</span></div><div class="line">        num = 1;</div><div class="line">        den = f[i];</div><div class="line">        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j=i-1; j &gt; 0; --j) {</div><div class="line">            Integer tmp = num;</div><div class="line">            num = den;</div><div class="line">            den = f[j]*den+tmp;</div><div class="line">            <span class="comment">//y = (double)f[j]+1/y;</span></div><div class="line">        }</div><div class="line">        <span class="comment">//y = (double)f[0]+1/y;</span></div><div class="line">        num = den*f[0]+num;</div><div class="line">        <span class="keywordflow">if</span> (den &gt;= den_bound) <span class="keywordflow">break</span>;</div><div class="line">        ++i;</div><div class="line">        <span class="keywordflow">if</span> (i &gt;= s) {</div><div class="line">            <span class="keywordflow">break</span>;</div><div class="line">        }</div><div class="line">    }</div><div class="line">}</div><div class="line"></div><div class="line"><span class="keywordtype">void</span> i_vti_v(RBlackbox&amp; Res, <a class="code" href="class_lin_box_1_1_blas_matrix.html">DenseMatrix&lt;Rationals &gt;</a>&amp; M, DVector&amp; den, Integer&amp; detPrec)</div><div class="line">{</div><div class="line">    detPrec=1;</div><div class="line">    Rationals Q;</div><div class="line">    <span class="keywordtype">int</span> n = M.<a name="a12"></a><a class="code" href="class_lin_box_1_1_blas_matrix.html#abc1cec653df62fe63099520554ce3128">coldim</a>();</div><div class="line">    <span class="comment">//DVector denV(n,1);</span></div><div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i &lt; den.size();++i) den[i]=1;</div><div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i &lt; n; ++i) {</div><div class="line">        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j=0; j &lt;=i ; ++j) {</div><div class="line">            Integer q_num =0;</div><div class="line">            Integer q_den =1;</div><div class="line">            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k=0; k &lt; n; ++k) {</div><div class="line">                Integer deno_ik, nume_ik, deno_jk, nume_jk, deno, nume;</div><div class="line">                Q.get_den (deno_ik, M.<a name="a13"></a><a class="code" href="class_lin_box_1_1_blas_matrix.html#ad510d47fabb58081275d705d5c94c023">getEntry</a>(k,i));</div><div class="line">                Q.get_num (nume_ik, M.<a class="code" href="class_lin_box_1_1_blas_matrix.html#ad510d47fabb58081275d705d5c94c023">getEntry</a>(k,i));</div><div class="line">                Q.get_den (deno_jk, M.<a class="code" href="class_lin_box_1_1_blas_matrix.html#ad510d47fabb58081275d705d5c94c023">getEntry</a>(k,j));</div><div class="line">                Q.get_num (nume_jk, M.<a class="code" href="class_lin_box_1_1_blas_matrix.html#ad510d47fabb58081275d705d5c94c023">getEntry</a>(k,j));</div><div class="line"></div><div class="line">                <span class="keywordflow">if</span> (i==k) {</div><div class="line">                    nume_ik = deno_ik-nume_ik;</div><div class="line">                }</div><div class="line">                <span class="keywordflow">else</span> {</div><div class="line">                    nume_ik = -nume_ik;</div><div class="line">                }</div><div class="line"></div><div class="line">                <span class="keywordflow">if</span> (j==k) {</div><div class="line">                    nume_jk = deno_jk-nume_jk;</div><div class="line">                }</div><div class="line">                <span class="keywordflow">else</span> {</div><div class="line">                    nume_jk = -nume_jk;</div><div class="line">                }</div><div class="line">                <span class="comment">//cout &lt;&lt; nume_ik &lt;&lt; nume_jk;</span></div><div class="line"></div><div class="line">                deno = deno_ik*deno_jk;</div><div class="line">                nume = nume_ik*nume_jk;</div><div class="line">                <span class="comment">//cout &lt;&lt; q_num &lt;&lt; &quot;/&quot; &lt;&lt; q_den &lt;&lt; &quot; &quot; ;</span></div><div class="line">                <span class="comment">//cout &lt;&lt; nume &lt;&lt; &quot;/&quot; &lt;&lt; deno &lt;&lt; &quot; &quot; ;</span></div><div class="line">                <span class="keywordflow">if</span> (deno==q_den) q_num+=nume;</div><div class="line">                <span class="keywordflow">else</span> {</div><div class="line">                    <span class="keywordflow">if</span> (nume != 0) {</div><div class="line">                        Integer g = gcd(q_den, deno);</div><div class="line">                        q_num = q_num*deno/g+nume*q_den/g;</div><div class="line">                        q_den = q_den*deno/g;</div><div class="line">                    }</div><div class="line">                }</div><div class="line">                <span class="comment">//cout &lt;&lt; q_num &lt;&lt; &quot;/&quot; &lt;&lt; q_den &lt;&lt; &quot; &quot; ;</span></div><div class="line">            }</div><div class="line">            <span class="keywordflow">if</span> (q_num != 0) {</div><div class="line">                <a class="code" href="class_lin_box_1_1_g_m_p_rational_element.html">Quotient</a> q(q_num,q_den);</div><div class="line">                <span class="keywordflow">if</span> (i!=j) {</div><div class="line">                    den[i]=lcm(den[i], q_den);</div><div class="line">                    den[j]=lcm(den[j], q_den);</div><div class="line">                    Res.setEntry(i,j,q);</div><div class="line">                    Res.setEntry(j,i,q);</div><div class="line">                    cout &lt;&lt; i &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; j &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; q_num &lt;&lt; <span class="stringliteral">&quot;/&quot;</span> &lt;&lt; q_den &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div><div class="line">                    cout &lt;&lt; j &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; i &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; q_num &lt;&lt; <span class="stringliteral">&quot;/&quot;</span> &lt;&lt; q_den &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div><div class="line">                }</div><div class="line">                <span class="keywordflow">else</span> {</div><div class="line">                    den[i]=lcm(den[i], q_den);</div><div class="line">                    Res.setEntry(i,j,q);</div><div class="line">                    cout &lt;&lt; i &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; j &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; q_num &lt;&lt; <span class="stringliteral">&quot;/&quot;</span> &lt;&lt; q_den &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div><div class="line">                }</div><div class="line">            }</div><div class="line">        }</div><div class="line">    }</div><div class="line">    Integer d = 1;</div><div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i &lt; den.size(); ++i) {</div><div class="line">        detPrec *=den[i];</div><div class="line">        d = lcm(d, den[i]);</div><div class="line">    }</div><div class="line">    den[den.size()-1]=d;</div><div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=den.size()-2; i &gt;=0; --i) {</div><div class="line">        den[i]=d*den[i+1];</div><div class="line">    }</div><div class="line"></div><div class="line">}</div><div class="line"></div><div class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> RMatrix&gt;</div><div class="line"><span class="keywordtype">void</span> <a class="code" href="qchar_8_c.html#a4b96d819a68e0cb5bd6177ab8eaa4043">generate_precRatMat</a>(<span class="keywordtype">string</span>&amp; filename, RMatrix&amp; M, DVector&amp; den, Integer&amp; denPrec)</div><div class="line">{</div><div class="line">    <span class="keywordtype">int</span> prec=10;</div><div class="line">    denPrec = 1;</div><div class="line">    ifstream is(filename.c_str(), std::ios::in);</div><div class="line">    <span class="keywordtype">int</span> m,n;</div><div class="line">    <span class="keywordtype">char</span> c;</div><div class="line">    is &gt;&gt; m &gt;&gt; n;</div><div class="line">    <span class="keywordflow">do</span> is &gt;&gt; c; <span class="keywordflow">while</span> (isspace (c));</div><div class="line">    <span class="keywordflow">if</span> ((m &gt; M.<a name="a14"></a><a class="code" href="class_lin_box_1_1_blas_matrix.html#a3d6b8c8612d0b5b8a037a03f98935ff6">rowdim</a>()) || (n &gt; M.<a class="code" href="class_lin_box_1_1_blas_matrix.html#abc1cec653df62fe63099520554ce3128">coldim</a>())) {</div><div class="line">        cout &lt;&lt; m &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; n &lt;&lt; <span class="stringliteral">&quot; &quot;</span> ;</div><div class="line">        cout &lt;&lt; <span class="stringliteral">&quot;Wrong matrix size\n&quot;</span>;</div><div class="line">        <span class="keywordflow">return</span>;</div><div class="line">    }</div><div class="line"></div><div class="line">    cout &lt;&lt; <span class="stringliteral">&quot;Reading matrix\n&quot;</span>;</div><div class="line"></div><div class="line">    den.resize(m,1);</div><div class="line">    <span class="keywordflow">while</span> (1) {</div><div class="line"><span class="preprocessor">#if 0</span></div><div class="line">        <span class="keywordflow">while</span> (is &gt;&gt; m) <span class="comment">//temp fix</span></div><div class="line">            <span class="keywordflow">if</span> (m==0) <span class="keywordflow">break</span>;<span class="comment">//temp fix</span></div><div class="line"><span class="preprocessor">#endif</span></div><div class="line">        is &gt;&gt; m;<span class="comment">//temp fix</span></div><div class="line">        is &gt;&gt; n;</div><div class="line"><span class="preprocessor">#if 0</span></div><div class="line">        cout &lt;&lt; m &lt;&lt; n &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div><div class="line">        <span class="keywordtype">long</span> <span class="keywordtype">double</span> x;</div><div class="line">        is &gt;&gt; x;</div><div class="line"><span class="preprocessor">#endif</span></div><div class="line">        <span class="keywordtype">char</span> xstr[500];</div><div class="line">        <span class="keywordtype">char</span> numstr[500];</div><div class="line"><span class="preprocessor">#if 0</span></div><div class="line">        cout &lt;&lt; x &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div><div class="line">        sprintf(xstr, <span class="stringliteral">&quot;%100f&quot;</span>, x);</div><div class="line">        cout &lt;&lt; xstr &lt;&lt; <span class="stringliteral">&quot; &quot;</span> ;</div><div class="line">        is &gt;&gt; c; <span class="keywordtype">int</span> i=0;</div><div class="line">        <span class="keywordflow">while</span> (c!= <span class="charliteral">&#39;\n&#39;</span>) {</div><div class="line">            xstr[i]=c;</div><div class="line">            ++i;</div><div class="line">            is &gt;&gt; c;</div><div class="line">            <span class="keywordflow">if</span> (i&gt;=199) {</div><div class="line">                xstr[i]=0;</div><div class="line">                <span class="keywordflow">break</span>;</div><div class="line">            }</div><div class="line">        }</div><div class="line">        is &gt;&gt; c;</div><div class="line"><span class="preprocessor">#endif</span></div><div class="line">        is.getline(xstr,500);</div><div class="line"></div><div class="line">        Integer ten=1;</div><div class="line">        <span class="keywordflow">if</span> (strchr(xstr, <span class="charliteral">&#39;/&#39;</span>) != NULL) {</div><div class="line">            <span class="comment">//cout &lt;&lt; &quot;xstr &quot; &lt;&lt; xstr &lt;&lt; &quot;\n&quot;;</span></div><div class="line"><span class="comment"></span>            strcpy(numstr, strtok(xstr, <span class="stringliteral">&quot;/&quot;</span>));</div><div class="line">            <span class="keywordtype">char</span> tenstr[500];</div><div class="line">            strcpy(tenstr, strtok(NULL, <span class="stringliteral">&quot;/&quot;</span>));</div><div class="line">            <span class="keywordflow">if</span> (prec &lt; strlen(tenstr)) {</div><div class="line">                <span class="keywordtype">int</span> cut = strlen(tenstr)-prec;</div><div class="line">                tenstr[prec]=0;</div><div class="line">                <span class="comment">//c = numstr[strlen(numstr)-2];</span></div><div class="line">                numstr[strlen(numstr)-cut]=0;<span class="comment">//temp round down</span></div><div class="line">            }</div><div class="line">            Integer tmp(tenstr);</div><div class="line">            ten = tmp;</div><div class="line">            <span class="comment">//cout &lt;&lt; numstr &lt;&lt; &quot;/&quot;  &lt;&lt; ten &lt;&lt; &quot;\n&quot;;</span></div><div class="line">        }</div><div class="line">        <span class="keywordflow">else</span></div><div class="line">        {</div><div class="line"></div><div class="line">            <span class="comment">//    cout &lt;&lt; &quot;xstr&quot; &lt;&lt; xstr &lt;&lt; &quot; &quot; ;</span></div><div class="line">            <span class="keywordtype">int</span> i=0;</div><div class="line">            <span class="keywordtype">int</span> j=0;</div><div class="line">            c=xstr[i]; ++i;</div><div class="line">            <span class="keywordflow">while</span> (isspace (c)) {</div><div class="line">                <span class="keywordflow">if</span> (i &gt;=strlen(xstr)) <span class="keywordflow">break</span>;</div><div class="line">                c=xstr[i];</div><div class="line">                ++i;</div><div class="line">            }</div><div class="line">            <span class="keywordflow">if</span> (c==<span class="charliteral">&#39;-&#39;</span>) {</div><div class="line">                numstr[j]=c;++j;</div><div class="line">                <span class="keywordflow">if</span> (i &lt; strlen(xstr)) {</div><div class="line">                    c = xstr[i];</div><div class="line">                    ++i;</div><div class="line">                }</div><div class="line">            }</div><div class="line">            <span class="keywordflow">if</span> (c==<span class="charliteral">&#39;0&#39;</span>) {</div><div class="line">                <span class="comment">//cout &lt;&lt; &quot;zero&quot;;</span></div><div class="line">                <span class="keywordflow">if</span> (i &lt; strlen(xstr)) {</div><div class="line">                    c = xstr[i];</div><div class="line">                    ++i;</div><div class="line">                }</div><div class="line">            } <span class="comment">//else cout &lt;&lt; &quot; not 0&quot; &lt;&lt; c;</span></div><div class="line">            <span class="keywordflow">while</span> (strchr(<span class="stringliteral">&quot;0123456789&quot;</span>,c) != NULL) {</div><div class="line">                <span class="comment">//cout &lt;&lt; &quot;number&quot;;</span></div><div class="line">                numstr[j]=c; ++j;</div><div class="line">                <span class="keywordflow">if</span> (i &gt;=strlen(xstr)) <span class="keywordflow">break</span>;</div><div class="line">                c=xstr[i];</div><div class="line">                ++i;</div><div class="line">            }</div><div class="line">            <span class="keywordflow">if</span> (c==<span class="charliteral">&#39;.&#39;</span>) {</div><div class="line">                <span class="keywordflow">if</span> (i &lt; strlen(xstr)) {</div><div class="line">                    c = xstr[i];</div><div class="line">                    <span class="comment">//cout &lt;&lt; &quot;c&quot; &lt;&lt; c ;</span></div><div class="line">                    ++i;</div><div class="line">                    <span class="keywordflow">while</span> (strchr(<span class="stringliteral">&quot;0123456789&quot;</span>,c) != NULL) {</div><div class="line">                        numstr[j]=c;++j;</div><div class="line">                        <span class="keywordflow">if</span> (i &gt;=strlen(xstr)) <span class="keywordflow">break</span>;</div><div class="line">                        c=xstr[i];</div><div class="line">                        ++i;</div><div class="line">                    }</div><div class="line">                }</div><div class="line">                <span class="keywordflow">else</span> {</div><div class="line">                    cout &lt;&lt; <span class="stringliteral">&quot;wrong number format at .&quot;</span>;</div><div class="line">                    <span class="keywordflow">break</span>;</div><div class="line">                }</div><div class="line">            }</div><div class="line">            numstr[j]=0;</div><div class="line">            <span class="comment">//cout &lt;&lt; &quot;num&quot; &lt;&lt; numstr &lt;&lt; &quot; &quot; ;</span></div><div class="line"></div><div class="line">            <span class="keywordtype">size_t</span> dplaces=0;</div><div class="line">            <span class="keywordtype">int</span> exp=0;</div><div class="line">            j=0;</div><div class="line">            c = xstr[j]; ++j;</div><div class="line">            <span class="keywordflow">while</span> (c != <span class="charliteral">&#39;.&#39;</span>) {</div><div class="line">                <span class="keywordflow">if</span> (j &gt;= strlen(xstr)) <span class="keywordflow">break</span>;</div><div class="line">                c = xstr[j];</div><div class="line">                ++j;</div><div class="line">            }</div><div class="line">            <span class="keywordflow">if</span> (j &lt; strlen(xstr)) {</div><div class="line">                c = xstr[j]; ++j;</div><div class="line">                <span class="keywordflow">while</span> (c != <span class="charliteral">&#39;e&#39;</span>) {</div><div class="line">                    ++dplaces;</div><div class="line">                    ten *= 10;</div><div class="line">                    <span class="keywordflow">if</span> (j &gt;= strlen(xstr)) <span class="keywordflow">break</span>;</div><div class="line">                    c = xstr[j];</div><div class="line">                    ++j;</div><div class="line">                }</div><div class="line">            }</div><div class="line">            <span class="keywordflow">if</span> (j &lt; strlen(xstr)) {</div><div class="line">                sscanf(xstr+j, <span class="stringliteral">&quot;%d&quot;</span>, &amp;exp);</div><div class="line">                j=j-2;c = xstr[j];</div><div class="line">                <span class="keywordflow">while</span> (c==<span class="charliteral">&#39;0&#39;</span>) {</div><div class="line">                    ten/=10;</div><div class="line">                    --j;</div><div class="line">                    c = xstr[j];</div><div class="line">                }</div><div class="line">            }</div><div class="line"></div><div class="line">            dplaces -=exp;</div><div class="line">            <span class="keywordflow">if</span> (exp &gt; 0) {</div><div class="line">                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i &lt; exp; ++i) ten /=10;</div><div class="line">            }</div><div class="line">            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (exp &lt; 0) {</div><div class="line">                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i &lt; exp; ++i) ten *=10;</div><div class="line">            }</div><div class="line">            <span class="comment">//double nume = x * (double)ten;</span></div><div class="line">        }</div><div class="line">        Integer num (numstr);</div><div class="line">        Integer g;</div><div class="line"></div><div class="line"><span class="preprocessor">#ifdef _LB_CONT_FR</span></div><div class="line">        <span class="keywordtype">double</span> epsi = 1/(double)ten*10;</div><div class="line">        <span class="keywordtype">size_t</span> s=10;</div><div class="line">        continuedFractionIn(num, ten, epsi, s, ten);</div><div class="line"><span class="preprocessor">#endif</span></div><div class="line">        <span class="comment">//cout &lt;&lt; m &lt;&lt; &quot; &quot; &lt;&lt; n &lt;&lt; &quot; &quot; &lt;&lt; num &lt;&lt; &quot;/&quot; &lt;&lt; ten &lt;&lt; &quot;\n&quot;;</span></div><div class="line">        g = gcd(num,ten);</div><div class="line">        <span class="comment">//g =1;</span></div><div class="line">        <a class="code" href="class_lin_box_1_1_g_m_p_rational_element.html">Quotient</a> q(num/g,ten/g);</div><div class="line">        <span class="keywordflow">if</span> ((m==0)&amp;&amp;(n==0)&amp;&amp;(num==0)) <span class="keywordflow">break</span>;<span class="comment">//temp fix</span></div><div class="line">        <span class="comment">//M.setEntry(m-1,n-1,q);//temp fix</span></div><div class="line">        M.<a name="a15"></a><a class="code" href="class_lin_box_1_1_blas_matrix.html#aea76aa2fc1165009c22a1c353b2b3cf4">setEntry</a>(m,n,q);</div><div class="line">        den[m-1] = lcm(den[m-1],ten/g);</div><div class="line">    }</div><div class="line">    Integer d = 1;</div><div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i &lt; den.size(); ++i) {</div><div class="line">        denPrec *=den[i];</div><div class="line">        d = lcm(d, den[i]);</div><div class="line">    }</div><div class="line">    den[den.size()-1]=d;</div><div class="line">    cout &lt;&lt; d &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div><div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=den.size()-2; i &gt;=0; --i) {</div><div class="line">        den[i]=d*den[i+1];</div><div class="line">        cout &lt;&lt; den[i] &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div><div class="line">    }</div><div class="line">}</div><div class="line"></div><div class="line"><span class="preprocessor">#undef _LB_CONT_FR</span></div><div class="line"></div><div class="line"><span class="comment">// Local Variables:</span></div><div class="line"><span class="comment">// mode: C++</span></div><div class="line"><span class="comment">// tab-width: 4</span></div><div class="line"><span class="comment">// indent-tabs-mode: nil</span></div><div class="line"><span class="comment">// c-basic-offset: 4</span></div><div class="line"><span class="comment">// End:</span></div><div class="line"><span class="comment">// vim:sts=4:sw=4:ts=4:et:sr:cino=&gt;s,f0,{0,g0,(0,\:0,t0,+0,=s</span></div></div><!-- fragment --> </div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Wed Jun 5 2019 14:05:42 for linbox by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
