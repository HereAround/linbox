<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>linbox: examples/mats.C</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">linbox
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',false,false,'search.php','Search');
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">examples/mats.C</div>  </div>
</div><!--header-->
<div class="contents">
<p>example matrices that were chosen for Smith form testing.</p><dl class="section author"><dt>Author</dt><dd>bds &amp; zw</dd></dl>
<p>Various Smith form algorithms may be used for matrices over the integers or over Z_m. Moduli greater than 2^32 are not supported here. Several types of example matrices may be constructed or the matrix be read from a file. Run the program with no arguments for a synopsis of the command line parameters.</p>
<p>For the "adaptive" method, the matrix must be over the integers. This is expected to work best for large matrices.</p>
<p>For the "2local" method, the computation is done mod 2^32.</p>
<p>For the "local" method, the modulus must be a prime power.</p>
<p>For the "ilio" method, the modulus may be arbitrary composite. If the modulus is a multiple of the integer determinant, the integer Smith form is obtained. Determinant plus ilio may be best for smaller matrices.</p>
<p>This example was used during the design process of the adaptive algorithm.</p>
<div class="fragment"><div class="line"><span class="comment">/*</span></div><div class="line"><span class="comment"> * examples/mats.C</span></div><div class="line"><span class="comment"> *</span></div><div class="line"><span class="comment"> * Copyright (C) 2017  D. Saunders, Z. Wang, J-G Dumas</span></div><div class="line"><span class="comment"> * ========LICENCE========</span></div><div class="line"><span class="comment"> * This file is part of the library LinBox.</span></div><div class="line"><span class="comment"> *</span></div><div class="line"><span class="comment"> * LinBox is free software: you can redistribute it and/or modify</span></div><div class="line"><span class="comment"> * it under the terms of the  GNU Lesser General Public</span></div><div class="line"><span class="comment"> * License as published by the Free Software Foundation; either</span></div><div class="line"><span class="comment"> * version 2.1 of the License, or (at your option) any later version.</span></div><div class="line"><span class="comment"> *</span></div><div class="line"><span class="comment"> * This library is distributed in the hope that it will be useful,</span></div><div class="line"><span class="comment"> * but WITHOUT ANY WARRANTY; without even the implied warranty of</span></div><div class="line"><span class="comment"> * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU</span></div><div class="line"><span class="comment"> * Lesser General Public License for more details.</span></div><div class="line"><span class="comment"> *</span></div><div class="line"><span class="comment"> * You should have received a copy of the GNU Lesser General Public</span></div><div class="line"><span class="comment"> * License along with this library; if not, write to the Free Software</span></div><div class="line"><span class="comment"> * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301  USA</span></div><div class="line"><span class="comment"> * ========LICENCE========</span></div><div class="line"><span class="comment"> */</span></div><div class="line"></div><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="linbox-config_8h.html">linbox/linbox-config.h</a>&gt;</span></div><div class="line"></div><div class="line"><span class="preprocessor">#include &lt;iostream&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;string&gt;</span></div><div class="line"></div><div class="line"><span class="keyword">using namespace </span><a class="code" href="namespacestd.html">std</a>;</div><div class="line"></div><div class="line"></div><div class="line"><span class="comment">//#include &lt;linbox/ring/modular.h&gt;</span></div><div class="line"><span class="comment">//#include &quot;givaro/zring.h&quot;</span></div><div class="line"><span class="comment">//#include &quot;linbox/integer.h&quot;</span></div><div class="line"></div><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="timer_8h.html">linbox/util/timer.h</a>&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="dense-matrix_8h.html">linbox/matrix/dense-matrix.h</a>&gt;</span></div><div class="line"></div><div class="line"><span class="comment">// place A: Edit here and at place B for ring change</span></div><div class="line"><span class="comment">//#include &lt;linbox/ring/pir-modular-int32.h&gt;</span></div><div class="line"><span class="comment">//#include &lt;linbox/ring/pir-ntl-zz_p.h&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;linbox/ring/pir-ntl-zz_p.h&gt;</span></div><div class="line"></div><div class="line"><span class="keyword">using namespace </span><a class="code" href="namespace_lin_box.html">LinBox</a>;</div><div class="line"></div><div class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> PIR&gt;</div><div class="line"><span class="keywordtype">void</span> <a name="a0"></a><a class="code" href="blackbox_2smith_8_c.html#aadb18d2b614ec62a4c08f3a9b52a72f8">Mat</a>(<a name="_a1"></a><a class="code" href="class_lin_box_1_1_blas_matrix.html">DenseMatrix&lt;PIR&gt;</a>&amp; M, PIR&amp; R, <span class="keywordtype">int</span> &amp; n, <span class="keywordtype">string</span> src) ;</div><div class="line"></div><div class="line"><span class="keywordtype">int</span> main(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span>* argv[])</div><div class="line">{</div><div class="line">    <span class="keywordflow">if</span> (argc &lt; 3 or argc &gt; 4) {</div><div class="line"></div><div class="line">        cout &lt;&lt; <span class="stringliteral">&quot;usage: &quot;</span> &lt;&lt; argv[0] &lt;&lt; <span class="stringliteral">&quot; type n [filename]&quot;</span>  &lt;&lt; endl;</div><div class="line"></div><div class="line">        cout &lt;&lt; <span class="stringliteral">&quot; type = `random&#39;, `random-rough&#39;, `tref&#39;, or `fib&#39;,&quot;</span></div><div class="line">             &lt;&lt; <span class="stringliteral">&quot; and n is the dimension&quot;</span> &lt;&lt; endl;</div><div class="line">        cout  &lt;&lt; <span class="stringliteral">&quot; If filename is present, matrix is written there, else to cout.&quot;</span> &lt;&lt; endl;</div><div class="line"></div><div class="line">        <span class="keywordflow">return</span> 0;</div><div class="line">    }</div><div class="line"></div><div class="line">    <span class="keywordtype">string</span> type = argv[1];</div><div class="line"></div><div class="line">    <span class="keywordtype">int</span> n = atoi(argv[2]);</div><div class="line"></div><div class="line"><span class="comment">// place B: Edit here and at place A for ring change</span></div><div class="line">    <span class="comment">//typedef PIRModular&lt;int32_t&gt; PIR;</span></div><div class="line">    <span class="keyword">typedef</span> Givaro::ZRing&lt;Integer&gt; PIR;</div><div class="line">    PIR R;</div><div class="line">    <a class="code" href="class_lin_box_1_1_blas_matrix.html">DenseMatrix&lt;PIR&gt;</a> M(R);</div><div class="line"></div><div class="line">    <a class="code" href="blackbox_2smith_8_c.html#aadb18d2b614ec62a4c08f3a9b52a72f8">Mat</a>(M,R,n,type);</div><div class="line">    <span class="keywordflow">if</span> (argc == 4) {</div><div class="line">        ofstream out(argv[3]);</div><div class="line">        M.write(out) &lt;&lt; endl;</div><div class="line">    } <span class="keywordflow">else</span> {</div><div class="line">        M.write(cout) &lt;&lt; endl;</div><div class="line">    }</div><div class="line">}<span class="comment">// main</span></div><div class="line"></div><div class="line"><span class="keyword">template</span> &lt; <span class="keyword">class</span> Ring &gt;</div><div class="line"><span class="keywordtype">void</span> scramble(<a class="code" href="class_lin_box_1_1_blas_matrix.html">DenseMatrix&lt;Ring&gt;</a>&amp; M)</div><div class="line">{</div><div class="line"></div><div class="line">    Ring R = M.<a name="a2"></a>field();</div><div class="line"></div><div class="line">    <span class="keywordtype">int</span> N,n = (int)M.<a name="a3"></a><a class="code" href="class_lin_box_1_1_blas_matrix.html#a3d6b8c8612d0b5b8a037a03f98935ff6">rowdim</a>(); <span class="comment">// number of random basic row and col ops.</span></div><div class="line">    N = n;</div><div class="line"></div><div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt; N; ++k) {</div><div class="line"></div><div class="line">        <span class="keywordtype">int</span> i = rand()%(int)M.<a class="code" href="class_lin_box_1_1_blas_matrix.html#a3d6b8c8612d0b5b8a037a03f98935ff6">rowdim</a>();</div><div class="line"></div><div class="line">        <span class="keywordtype">int</span> j = rand()%(int)M.<a name="a4"></a><a class="code" href="class_lin_box_1_1_blas_matrix.html#abc1cec653df62fe63099520554ce3128">coldim</a>();</div><div class="line"></div><div class="line">        <span class="keywordflow">if</span> (i == j) <span class="keywordflow">continue</span>;</div><div class="line"></div><div class="line">            <span class="comment">// M*i += alpha M*j and Mi* += beta Mj</span></div><div class="line"></div><div class="line">            <span class="comment">//int a = rand()%2;</span></div><div class="line">        <span class="keywordtype">int</span> a = 0;</div><div class="line"></div><div class="line">        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> l = 0; l &lt; M.<a class="code" href="class_lin_box_1_1_blas_matrix.html#a3d6b8c8612d0b5b8a037a03f98935ff6">rowdim</a>(); ++l) {</div><div class="line"></div><div class="line">            <span class="keywordflow">if</span> (a)</div><div class="line"></div><div class="line">                R.subin(M[(<span class="keywordtype">size_t</span>)l][(<span class="keywordtype">size_t</span>)i], M[(<span class="keywordtype">size_t</span>)l][(<span class="keywordtype">size_t</span>)j]);</div><div class="line"></div><div class="line">            <span class="keywordflow">else</span></div><div class="line"></div><div class="line">                R.addin(M[(<span class="keywordtype">size_t</span>)l][(<span class="keywordtype">size_t</span>)i], M[(<span class="keywordtype">size_t</span>)l][(<span class="keywordtype">size_t</span>)j]);</div><div class="line"></div><div class="line">                <span class="comment">//K.axpy(c, M.getEntry(l, i), x, M.getEntry(l, j));</span></div><div class="line">                <span class="comment">//M.setEntry(l, i, c);</span></div><div class="line">        }</div><div class="line"></div><div class="line">            <span class="comment">//a = rand()%2;</span></div><div class="line"></div><div class="line">        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> l = 0; l &lt; M.<a class="code" href="class_lin_box_1_1_blas_matrix.html#abc1cec653df62fe63099520554ce3128">coldim</a>(); ++l) {</div><div class="line"></div><div class="line">            <span class="keywordflow">if</span> (a)</div><div class="line"></div><div class="line">                R.subin(M[(<span class="keywordtype">size_t</span>)i][l], M[(<span class="keywordtype">size_t</span>)j][l]);</div><div class="line">            <span class="keywordflow">else</span></div><div class="line"></div><div class="line">                R.addin(M[(<span class="keywordtype">size_t</span>)i][l], M[(<span class="keywordtype">size_t</span>)j][l]);</div><div class="line">        }</div><div class="line">    }</div><div class="line">}</div><div class="line"></div><div class="line"><span class="comment">// This mat will have s, near sqrt(n), distinct invariant factors,</span></div><div class="line"><span class="comment">// each repeated twice), involving the s primes 101, 103, ...</span></div><div class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> PIR&gt;</div><div class="line"><span class="keywordtype">void</span> RandomRoughMat(<a class="code" href="class_lin_box_1_1_blas_matrix.html">DenseMatrix&lt;PIR&gt;</a>&amp; M, PIR&amp; R, <span class="keywordtype">int</span> n) {</div><div class="line">    M.<a name="a5"></a><a class="code" href="class_lin_box_1_1_blas_matrix.html#a7b4b2ef1fd510b580b4181a24a7b3d1e">resize</a>((<span class="keywordtype">size_t</span>)n, (<span class="keywordtype">size_t</span>)n, R.zero);</div><div class="line">    <span class="keywordflow">if</span> (n &gt; 10000) {cerr &lt;&lt; <span class="stringliteral">&quot;n too big&quot;</span> &lt;&lt; endl; exit(-1);}</div><div class="line">    <span class="keywordtype">int</span> jth_factor[130] =</div><div class="line">        {2, 3, 5, 7, 11, 13, 17, 19, 23, 29, 31, 37, 41, 43, 47, 53, 59, 61, 67,</div><div class="line">         71, 73, 79, 83, 89, 97, 101, 103, 107, 109, 113, 127, 131, 137, 139, 149,</div><div class="line">         151, 157, 163, 167, 173, 179, 181, 191, 193, 197, 199, 211, 223, 227, 229,</div><div class="line">         233, 239, 241, 251, 257, 263, 269, 271, 277, 281, 283, 293, 307, 311, 313,</div><div class="line">         317, 331, 337, 347, 349, 353, 359, 367, 373, 379, 383, 389, 397, 401, 409,</div><div class="line">         419, 421, 431, 433, 439, 443, 449, 457, 461, 463, 467, 479, 487, 491, 499,</div><div class="line">         503, 509, 521, 523, 541, 547, 557, 563, 569, 571, 577, 587, 593, 599, 601,</div><div class="line">         607, 613, 617, 619, 631, 641, 643, 647, 653, 659, 661, 673, 677, 683, 691,</div><div class="line">         701, 709, 719, 727, 733};</div><div class="line"></div><div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j= 0, i = 0 ; i &lt; n; ++j)</div><div class="line">    {</div><div class="line">        <span class="keyword">typename</span> PIR::Element v; R.init(v, jth_factor[25+j]);</div><div class="line">        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = j ; k &gt; 0 &amp;&amp; i &lt; n ; --k)</div><div class="line">        {   M[(size_t)i][(<span class="keywordtype">size_t</span>)i] = v; ++i;</div><div class="line">        <span class="keywordflow">if</span> (i &lt; n) {M[(size_t)i][(<span class="keywordtype">size_t</span>)i] = v; ++i;}</div><div class="line">        }</div><div class="line">    }</div><div class="line">    scramble(M);</div><div class="line">}</div><div class="line"></div><div class="line"><span class="comment">// This mat will have the same nontrivial invariant factors as</span></div><div class="line"><span class="comment">// diag(1,2,3,5,8, ... 999, 0, 1, 2, ...).</span></div><div class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> PIR&gt;</div><div class="line"><span class="keywordtype">void</span> RandomFromDiagMat(<a class="code" href="class_lin_box_1_1_blas_matrix.html">DenseMatrix&lt;PIR&gt;</a>&amp; M, PIR&amp; R, <span class="keywordtype">int</span> n) {</div><div class="line">    M.<a class="code" href="class_lin_box_1_1_blas_matrix.html#a7b4b2ef1fd510b580b4181a24a7b3d1e">resize</a>((<span class="keywordtype">size_t</span>)n,(<span class="keywordtype">size_t</span>) n, R.zero);</div><div class="line"></div><div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i= 0 ; i &lt; n; ++i)</div><div class="line"></div><div class="line">        R.init(M[(<span class="keywordtype">size_t</span>)i][(<span class="keywordtype">size_t</span>)i], i % 1000 + 1);</div><div class="line">    scramble(M);</div><div class="line"></div><div class="line">}</div><div class="line"></div><div class="line"><span class="comment">// This mat will have the same nontrivial invariant factors as</span></div><div class="line"><span class="comment">// diag(1,2,3,5,8, ... fib(k)), where k is about sqrt(n).</span></div><div class="line"><span class="comment">// The basic matrix is block diagonal with i-th block of order i and</span></div><div class="line"><span class="comment">// being a tridiagonal {-1,0,1} matrix whose snf = diag(i-1 1&#39;s, fib(i)),</span></div><div class="line"><span class="comment">// where fib(1) = 1, fib(2) = 2.  But note that, depending on n,</span></div><div class="line"><span class="comment">// the last block may be truncated, thus repeating an earlier fibonacci number.</span></div><div class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> PIR&gt;</div><div class="line"><span class="keywordtype">void</span> RandomFibMat(<a class="code" href="class_lin_box_1_1_blas_matrix.html">DenseMatrix&lt;PIR&gt;</a>&amp; M, PIR&amp; R, <span class="keywordtype">int</span> n) {</div><div class="line">    M.<a class="code" href="class_lin_box_1_1_blas_matrix.html#a7b4b2ef1fd510b580b4181a24a7b3d1e">resize</a>((<span class="keywordtype">size_t</span>)n,(<span class="keywordtype">size_t</span>) n, R.zero);</div><div class="line"></div><div class="line">    <span class="keyword">typename</span> PIR::Element pmone; R.assign(pmone, R.one);</div><div class="line"></div><div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i= 0 ; i &lt; n; ++i) M[(<span class="keywordtype">size_t</span>)i][(size_t)i] = R.one;</div><div class="line"></div><div class="line">    <span class="keywordtype">int</span> j = 1, k = 0;</div><div class="line"></div><div class="line">    for (<span class="keywordtype">int</span> i= 0 ; i &lt; n-1; ++i) {</div><div class="line"></div><div class="line">        <span class="keywordflow">if</span> ( i == k) {</div><div class="line"></div><div class="line">            M[(size_t)i][(<span class="keywordtype">size_t</span>)i+1] = R.<a name="a6"></a>zero;</div><div class="line"></div><div class="line">            k += ++j;</div><div class="line">        }</div><div class="line"></div><div class="line">        <span class="keywordflow">else</span> {</div><div class="line"></div><div class="line">            M[(size_t)i][(<span class="keywordtype">size_t</span>)i+1] = pmone;</div><div class="line"></div><div class="line">            R.negin(pmone);</div><div class="line">        }</div><div class="line">        R.neg(M[(<span class="keywordtype">size_t</span>)i+1][(<span class="keywordtype">size_t</span>)i], M[(<span class="keywordtype">size_t</span>)i][(<span class="keywordtype">size_t</span>)i+1]);</div><div class="line">    }</div><div class="line">    scramble(M);</div><div class="line">}</div><div class="line"></div><div class="line"></div><div class="line"><span class="comment">// special mats tref and krat</span></div><div class="line"></div><div class="line"><span class="comment">// Trefethen&#39;s challenge #7 mat (primes on diag, 1&#39;s on 2^e bands).</span></div><div class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> PIR&gt;</div><div class="line"><span class="keywordtype">void</span> TrefMat(<a class="code" href="class_lin_box_1_1_blas_matrix.html">DenseMatrix&lt;PIR&gt;</a>&amp; M, PIR&amp; R, <span class="keywordtype">int</span> n) {</div><div class="line">    M.<a class="code" href="class_lin_box_1_1_blas_matrix.html#a7b4b2ef1fd510b580b4181a24a7b3d1e">resize</a>((<span class="keywordtype">size_t</span>)n, (<span class="keywordtype">size_t</span>)n, R.zero);</div><div class="line"></div><div class="line">    std::vector&lt;int&gt; power2;</div><div class="line"></div><div class="line">    <span class="keywordtype">int</span> i = 1;</div><div class="line"></div><div class="line">    <span class="keywordflow">do</span> {</div><div class="line"></div><div class="line">        power2. push_back(i);</div><div class="line"></div><div class="line">        i *= 2;</div><div class="line">    } <span class="keywordflow">while</span> (i &lt; n);</div><div class="line"></div><div class="line">    std::ifstream in (<span class="stringliteral">&quot;prime&quot;</span>, std::ios::in);</div><div class="line"></div><div class="line">    <span class="keywordflow">for</span> ( i = 0; i &lt; n; ++ i)</div><div class="line"></div><div class="line">        in &gt;&gt; M[(<span class="keywordtype">size_t</span>)i][(size_t)i];</div><div class="line"></div><div class="line">    std::vector&lt;int&gt;::iterator p;</div><div class="line"></div><div class="line">    <span class="keywordflow">for</span> ( i = 0; i &lt; n; ++ i) {</div><div class="line"></div><div class="line">        <span class="keywordflow">for</span> ( p = power2. begin(); (p != power2. end()) &amp;&amp; (*p &lt;= i); ++ p)</div><div class="line">            M[(<span class="keywordtype">size_t</span>)i][(size_t)(i - *p)] = 1;</div><div class="line"></div><div class="line">        <span class="keywordflow">for</span> ( p = power2. begin(); (p != power2. end()) &amp;&amp; (*p &lt; n - i); ++ p)</div><div class="line">            M[(<span class="keywordtype">size_t</span>)i][(size_t)(i + *p)] = 1;</div><div class="line">    }</div><div class="line"></div><div class="line">}</div><div class="line"></div><div class="line"><span class="keyword">struct </span>pwrlist</div><div class="line">{</div><div class="line">    vector&lt;integer&gt; m;</div><div class="line">    pwrlist(<a class="code" href="group__integers.html#ga69460c665a80daebb395e45f6f76db54">integer</a> q)</div><div class="line">        { m.push_back(1); m.push_back(q); <span class="comment">//cout &lt;&lt; &quot;pwrlist &quot; &lt;&lt; m[0] &lt;&lt; &quot; &quot; &lt;&lt; m[1] &lt;&lt; endl;</span></div><div class="line">        }</div><div class="line">    <a class="code" href="group__integers.html#ga69460c665a80daebb395e45f6f76db54">integer</a> operator[](<span class="keywordtype">int</span> e)</div><div class="line">        {</div><div class="line">            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = (<span class="keywordtype">int</span>)m.size(); i &lt;= e; ++i) m.push_back(m[1]*m[(<span class="keywordtype">size_t</span>)i-1]);</div><div class="line">            <span class="keywordflow">return</span> m[(size_t)e];</div><div class="line">        }</div><div class="line">};</div><div class="line"></div><div class="line"><span class="comment">// Read &quot;1&quot; or &quot;q&quot; or &quot;q^e&quot;, for some (small) exponent e.</span></div><div class="line"><span class="comment">// Return value of the power of q at q = _q.</span></div><div class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> num&gt;</div><div class="line">num&amp; qread(num&amp; Val, pwrlist&amp; M, istream&amp; in)</div><div class="line">{</div><div class="line">    <span class="keywordtype">char</span> c;</div><div class="line">    in &gt;&gt; c; <span class="comment">// next nonwhitespace</span></div><div class="line">    <span class="keywordflow">if</span> (c == <span class="charliteral">&#39;0&#39;</span>) <span class="keywordflow">return</span> Val = 0;</div><div class="line">    <span class="keywordflow">if</span> (c == <span class="charliteral">&#39;1&#39;</span>) <span class="keywordflow">return</span> Val = 1;</div><div class="line">    <span class="keywordflow">if</span> (c != <span class="charliteral">&#39;p&#39;</span> &amp;&amp; c != <span class="charliteral">&#39;q&#39;</span>) { cout &lt;&lt; <span class="stringliteral">&quot;exiting due to unknown char &quot;</span> &lt;&lt; c &lt;&lt; endl; exit(-1);}</div><div class="line">    in.get(c);</div><div class="line">    <span class="keywordflow">if</span> (c !=<span class="charliteral">&#39;^&#39;</span>) {in.putback(c); <span class="keywordflow">return</span> Val = M[1];}</div><div class="line">    <span class="keywordflow">else</span></div><div class="line">    { <span class="keywordtype">int</span> expt; in &gt;&gt; expt;</div><div class="line">    <span class="keywordflow">return</span> Val = M[expt];</div><div class="line">    };</div><div class="line">}</div><div class="line"></div><div class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> PIR&gt;</div><div class="line"><span class="keywordtype">void</span> KratMat(<a class="code" href="class_lin_box_1_1_blas_matrix.html">DenseMatrix&lt;PIR&gt;</a>&amp; M, PIR&amp; R, <span class="keywordtype">int</span> q)</div><div class="line">{</div><div class="line">    pwrlist pwrs(q);</div><div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; M.<a class="code" href="class_lin_box_1_1_blas_matrix.html#a3d6b8c8612d0b5b8a037a03f98935ff6">rowdim</a>(); ++ i)</div><div class="line"></div><div class="line">        <span class="keywordflow">for</span> ( <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> j = 0; j &lt; M.<a class="code" href="class_lin_box_1_1_blas_matrix.html#abc1cec653df62fe63099520554ce3128">coldim</a>(); ++ j) {</div><div class="line">            <span class="keywordtype">int</span> Val;</div><div class="line">            qread(Val, pwrs, cin);</div><div class="line">            R. init (M[(<span class="keywordtype">size_t</span>)i][(<span class="keywordtype">size_t</span>)j], Val);</div><div class="line">        }</div><div class="line">}</div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> PIR&gt;</div><div class="line"><span class="keywordtype">void</span> <a class="code" href="blackbox_2smith_8_c.html#aadb18d2b614ec62a4c08f3a9b52a72f8">Mat</a>(<a class="code" href="class_lin_box_1_1_blas_matrix.html">DenseMatrix&lt;PIR&gt;</a>&amp; M, PIR&amp; R, <span class="keywordtype">int</span> &amp; n,</div><div class="line">         <span class="keywordtype">string</span> src) {</div><div class="line"></div><div class="line">    <span class="keywordflow">if</span> (src == <span class="stringliteral">&quot;random-rough&quot;</span>) RandomRoughMat(M, R, n);</div><div class="line"></div><div class="line">    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (src == <span class="stringliteral">&quot;random&quot;</span>) RandomFromDiagMat(M, R, n);</div><div class="line"></div><div class="line">    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (src == <span class="stringliteral">&quot;fib&quot;</span>) RandomFibMat(M, R, n);</div><div class="line"></div><div class="line">    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (src == <span class="stringliteral">&quot;tref&quot;</span>) TrefMat(M, R, n);</div><div class="line"></div><div class="line">    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (src == <span class="stringliteral">&quot;krat&quot;</span>) KratMat(M, R, n);</div><div class="line"></div><div class="line">    <span class="keywordflow">else</span> { <span class="comment">// from cin, mostly pointless, but may effect a file format change.</span></div><div class="line"></div><div class="line">            M.<a name="a7"></a><a class="code" href="class_lin_box_1_1_blas_matrix.html#abe724e99669a441971d60a55785a6cc6">read</a>(cin);</div><div class="line">        n = M.<a class="code" href="class_lin_box_1_1_blas_matrix.html#a3d6b8c8612d0b5b8a037a03f98935ff6">rowdim</a>();</div><div class="line">    }</div><div class="line"></div><div class="line">} <span class="comment">// Mat</span></div></div><!-- fragment --> </div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Wed Jun 5 2019 14:05:42 for linbox by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
